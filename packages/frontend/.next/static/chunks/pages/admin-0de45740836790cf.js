(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{7991:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return t(361)}])},361:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return h}});var a=t(1549),l=t(4194),n=t(9650),i=t.n(n),c=t(3394),r=t(1612),d=t(4330),o=t(8808),u=t.n(o);function h(){let{accessToken:e,fetchWithAuth:s}=(0,r.a)(),t=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";"success"===s?d.Am.success(e):"error"===s?d.Am.error(e):(0,d.Am)(e)},[n,o]=(0,l.useState)([]),[h,x]=(0,l.useState)(!1),[m,f]=(0,l.useState)(null);async function p(){x(!0);try{let e=await fetch("".concat(c.T,"/api/posts?page=1&pageSize=50")),s=await e.json();o(s.items||[])}finally{x(!1)}}async function j(a){if(!e){t("Login as admin required","error");return}if(confirm("Delete this post?")){f(a);try{let e=await s("".concat(c.T,"/api/posts/").concat(a),{method:"DELETE"});if(e.ok)t("Post deleted","success"),o(e=>e.filter(e=>e.id!==a));else{let s=await e.json().catch(()=>({message:"Failed"}));t(s.message||"Delete failed","error")}}finally{f(null)}}}return(0,l.useEffect)(()=>{p()},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:"Admin Dashboard - ChronicleX"})}),(0,a.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Admin Dashboard"}),h&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Loading..."}),(0,a.jsx)("div",{className:"overflow-x-auto border rounded-lg",children:(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[(0,a.jsx)("thead",{className:"bg-slate-100 dark:bg-slate-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left px-3 py-2",children:"Title"}),(0,a.jsx)("th",{className:"text-left px-3 py-2",children:"Status"}),(0,a.jsx)("th",{className:"text-left px-3 py-2",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:n.map(e=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"px-3 py-2",children:(0,a.jsx)(u(),{href:"/post/".concat(e.slug),className:"hover:underline",children:e.title})}),(0,a.jsx)("td",{className:"px-3 py-2",children:e.published?"Published":"Draft"}),(0,a.jsx)("td",{className:"px-3 py-2",children:(0,a.jsx)("button",{onClick:()=>j(e.id),disabled:m===e.id,className:"btn-outline px-3 py-1 text-xs",children:m===e.id?"Deleting...":"Delete"})})]},e.id))})]})})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=7991)}),_N_E=e.O()}]);